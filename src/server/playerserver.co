{EventEmitter} = require 'events'

module.exports = class PlayerServer extends EventEmitter
  (@library, @parser) ~>
    @parser.on \status, @~onStatus
    @parser.on \lifesigns, !~> @emit \lifesigns
    @parser.on \error, !(...) ~> @emit \error, ...

  request: !(request, cb=->) ->
    [name] = request.split ' '
    switch name
      case \listallinfo then cb {msg: @library.library ? {}}
      default @parser.sendRequest request, cb

  onStatus: !(arg) ->
    @emit \status, arg
